{% extends "admin/base_site.html" %}
{% load i18n admin_urls admin_static admin_list bootstrapped_goodies_tags %}

{% if not is_popup %}
  {% block breadcrumbs %}
    <ul class="breadcrumb">
      <li><a href="{% url 'admin:index' %}">{% trans 'Home' %}</a></li>
      <li><a href="{% url 'admin:app_list' 'data' %}">Data</a></li>
      <li><a href="{% url 'admin:data_underlying_changelist' %}">Underlyings</a></li>
      <li>Web Import</li>
    </ul>
  {% endblock %}
{% endif %}


{% block object-tools %}
  <div id="content-navbar-collapse" class="navbar-collapse collapse">
    <div class="nav navbar-nav navbar-right">
      <button id="import_thinkback" type="button" class="btn btn-primary">
        {% trans "Import Thinkback" %}
      </button>

      <button id="import_google" type="button" class="btn btn-primary">
        {% trans "Import Google" %}
      </button>

      <button id="import_yahoo" type="button" class="btn btn-primary">
        {% trans "Import Yahoo" %}
      </button>
    </div>
  </div>

  <script type="text/javascript">
    $("#import_thinkback").click(function () {
      $(location).attr("href", "{% url 'admin:csv_import' symbol %}");
    });
    $("#import_google").click(function () {
      $(location).attr("href", "{% url 'admin:web_import' 'google' symbol %}");
    });
    $("#import_yahoo").click(function () {
      $(location).attr("href", "{% url 'admin:web_import' 'yahoo' symbol %}");
    });
  </script>
{% endblock %}

{% block content %}
  {% if stocks %}
    <div class="alert alert-success">
      <a href="#" class="close" data-dismiss="alert">&times;</a>
      <strong>Imported!</strong> Stock have been insert into database.
    </div>
    <table class="table table-striped table-bordered">
    {% for stock in stocks %}
      {% if forloop.first %}
        <thead>
        <tr>
          <th>Date</th>
          <th>Open</th>
          <th>High</th>
          <th>Low</th>
          <th>Close</th>
          <th>Volume</th>
        </tr>
        </thead>
      {% endif %}

      {% if stock %}
        <tr>
          <td>{{ stock.date }}</td>
          <td>{{ stock.open }}</td>
          <td>{{ stock.high }}</td>
          <td>{{ stock.low }}</td>
          <td>{{ stock.close }}</td>
          <td>{{ stock.volume }}</td>
        </tr>
      {% else %}
        <tr>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
      {% endif %}
    {% endfor %}
    </table>
  {% else %}
    <div class="bs-example">
      <div class="alert alert-success">
        <a href="#" class="close" data-dismiss="alert">&times;</a>
        <strong>Success!</strong> Symbol have up-to-date.
      </div>
    </div>
  {% endif %}
{% endblock %}