{% extends "admin/base_site.html" %}
{% load i18n admin_urls admin_static admin_list bootstrapped_goodies_tags %}

{% if not is_popup %}
  {% block breadcrumbs %}
    <ul class="breadcrumb">
      <li><a href="{% url 'admin:index' %}">{% trans 'Home' %}</a></li>
      <li><a href="{% url 'admin:app_list' 'data' %}">Data</a></li>
      <li><a href="{% url 'admin:data_underlying_changelist' %}">Underlyings</a></li>
      <li>Csv Import</li>
    </ul>
  {% endblock %}
{% endif %}


{% block object-tools %}
  <div id="content-navbar-collapse" class="navbar-collapse collapse">
    <div class="nav navbar-nav navbar-right">
      <button id="import_thinkback" type="button" class="btn btn-primary">
        {% trans "Import Thinkback" %}
      </button>

      <button id="import_google" type="button" class="btn btn-primary">
        {% trans "Import Google" %}
      </button>

      <button id="import_yahoo" type="button" class="btn btn-primary">
        {% trans "Import Yahoo" %}
      </button>
    </div>
  </div>

  <script type="text/javascript">
    $("#import_thinkback").click(function () {
      $(location).attr("href", "{% url 'admin:csv_quote_import' symbol %}");
    });
    $("#import_google").click(function () {
      $(location).attr("href", "{% url 'admin:web_quote_import' 'google' symbol %}");
    });
    $("#import_yahoo").click(function () {
      $(location).attr("href", "{% url 'admin:web_quote_import' 'yahoo' symbol %}");
    });
  </script>
{% endblock %}


{% block content %}
  {% if files %}
    <div class="bs-example">
      <div class="alert alert-success">
        <a href="#" class="close" data-dismiss="alert">&times;</a>
        <strong>Success!</strong> All thinkback csv have been saved.
      </div>
    </div>
    <table class="table table-striped table-bordered">
    {% for f in files %}
      {% if forloop.first %}
        <thead>
        <tr>
          <th>No.</th>
          <th>Filename</th>
          <th>Stock</th>
          <th>Contracts</th>
          <th>Options</th>
        </tr>
        </thead>
      {% endif %}

      {% if f.stock.id %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ f.fname }}</td>
          <td>{{ f.stock }}</td>
          <td>{{ f.contracts }}</td>
          <td>{{ f.options }}</td>
        </tr>
      {% else %}
        <tr>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
      {% endif %}
    {% endfor %}
    </table>
  {% else %}
    <div class="bs-example">
      <div class="alert alert-warning">
        <a href="#" class="close" data-dismiss="alert">&times;</a>
        <strong>Empty!</strong> No new thinkback csv files in folder.
      </div>
    </div>
  {% endif %}

  {% if missing %}
    <label for="missing_date">Missing date:</label>
    <textarea id="missing_date" class="form-control" rows="2" onclick="$(this).select();"
      readonly style="background-color: white;">{{ missing }}</textarea>
  {% endif %}
{% endblock %}